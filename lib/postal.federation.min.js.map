{"version":3,"sources":["webpack:/webpack/universalModuleDefinition","postal.federation.js","webpack:/webpack/bootstrap 571432001af90c4f1ed7","webpack:/src/index.js","webpack:/external \"_\"","webpack:/external \"postal\""],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_1__","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_matchesFilter","channel","topic","direction","channelPresent","Object","prototype","hasOwnProperty","fedx","filters","topicMatch","_","any","binding","postal","configuration","resolver","compare","blacklisting","_config","filterMode","enabled","FederationClient","target","options","instanceId","pings","handshakeComplete","processSignalQ","args","signalReady","apply","processOutboundQ","send","processInboundQ","msg","onFederatedMsg","_interopRequire","obj","__esModule","createUUID","s","hexDigits","i","substr","Math","floor","random","join","_id","undefined","_oldId","publish","SYSTEM_CHANNEL","data","oldId","newId","NO_OP","_ready","_inboundQueue","_outboundQueue","_signalQueue","_defaults","filterDirection","packingSlips","ping","type","timeStamp","Date","ticket","pong","pingData","message","env","envelope","disconnect","bundle","handlers","federation.ping","source","setInstanceId","packingSlip","sendPong","sendBundle","getPackingSlip","federation.pong","callback","contains","clients","push","remoteId","localId","transport","federation.disconnect","without","transportName","doNotNotify","federation.message","lastSender","federation.bundle","each","slip","extend","sendPing","origPackingSlip","slips","sendMessage","originId","clone","knownIds","length","include","concat","onMessage","shouldProcess","Error","props","ctrProps","FedXClient","arguments","create","transports","in","out","addFilter","isArray","filter","dir","removeFilter","canSendRemote","configure","cfg","defaults","Array","slice","_getTransports","reduce","memo","name","targets","addWireTap","subscribe","shift"],"mappings":"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","file":"postal.federation.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"postal\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"postal\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postalFedx\"] = factory(require(\"_\"), require(\"postal\"));\n\telse\n\t\troot[\"postalFedx\"] = factory(root[\"_\"], root[\"postal\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","/*!\n *  * postal.federation - A base plugin for federating instances of postal.js across various boundaries.\n *  * Author: Jim Cowart (http://ifandelse.com)\n *  * Version: v0.4.0\n *  * Url: http://github.com/postaljs/postal.federation\n *  * License(s): (MIT OR GPL-2.0)\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"postal\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"postal\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postalFedx\"] = factory(require(\"_\"), require(\"postal\"));\n\telse\n\t\troot[\"postalFedx\"] = factory(root[\"_\"], root[\"postal\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// istanbul ignore next\n\t\n\tvar _interopRequire = function (obj) { return obj && obj.__esModule ? obj[\"default\"] : obj; };\n\t\n\tvar _ = _interopRequire(__webpack_require__(1));\n\t\n\tvar postal = _interopRequire(__webpack_require__(2));\n\t\n\tif (!postal.createUUID) {\n\t\tpostal.createUUID = function () {\n\t\t\tvar s = [];\n\t\t\tvar hexDigits = \"0123456789abcdef\";\n\t\t\tfor (var i = 0; i < 36; i++) {\n\t\t\t\ts[i] = hexDigits.substr(Math.floor(Math.random() * 16), 1);\n\t\t\t}\n\t\t\ts[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n\t\t\t/* jshint ignore:start */\n\t\t\ts[19] = hexDigits.substr(s[19] & 3 | 8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n\t\t\t/* jshint ignore:end */\n\t\t\ts[8] = s[13] = s[18] = s[23] = \"-\";\n\t\t\treturn s.join(\"\");\n\t\t};\n\t}\n\tif (!postal.instanceId) {\n\t\tpostal.instanceId = (function () {\n\t\t\tvar _id = undefined,\n\t\t\t    _oldId = undefined;\n\t\t\treturn function (id) {\n\t\t\t\tif (id) {\n\t\t\t\t\t_oldId = _id;\n\t\t\t\t\t_id = id;\n\t\t\t\t\tpostal.publish({\n\t\t\t\t\t\tchannel: postal.configuration.SYSTEM_CHANNEL,\n\t\t\t\t\t\ttopic: \"instanceId.changed\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\toldId: _oldId,\n\t\t\t\t\t\t\tnewId: _id\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn _id;\n\t\t\t};\n\t\t})();\n\t}\n\t\n\tvar NO_OP = function NO_OP() {};\n\tvar _ready = false;\n\tvar _inboundQueue = [];\n\tvar _outboundQueue = [];\n\tvar _signalQueue = [];\n\tvar _defaults = {\n\t\tenabled: true,\n\t\tfilterMode: \"whitelist\",\n\t\tfilterDirection: \"both\"\n\t};\n\tvar _config = _defaults;\n\tfunction _matchesFilter(channel, topic, direction) {\n\t\tvar channelPresent = Object.prototype.hasOwnProperty.call(fedx.filters[direction], channel);\n\t\tvar topicMatch = channelPresent && _.any(fedx.filters[direction][channel], function (binding) {\n\t\t\treturn postal.configuration.resolver.compare(binding, topic);\n\t\t});\n\t\tvar blacklisting = _config.filterMode === \"blacklist\";\n\t\treturn _config.enabled && (blacklisting && (!channelPresent || channelPresent && !topicMatch) || !blacklisting && channelPresent && topicMatch);\n\t};\n\t\n\tvar packingSlips = {\n\t\tping: function ping() {\n\t\t\treturn {\n\t\t\t\ttype: \"federation.ping\",\n\t\t\t\tinstanceId: postal.instanceId(),\n\t\t\t\ttimeStamp: new Date(),\n\t\t\t\tticket: postal.createUUID()\n\t\t\t};\n\t\t},\n\t\tpong: function pong(ping) {\n\t\t\treturn {\n\t\t\t\ttype: \"federation.pong\",\n\t\t\t\tinstanceId: postal.instanceId(),\n\t\t\t\ttimeStamp: new Date(),\n\t\t\t\tpingData: {\n\t\t\t\t\tinstanceId: ping.instanceId,\n\t\t\t\t\ttimeStamp: ping.timeStamp,\n\t\t\t\t\tticket: ping.ticket\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tmessage: function message(env) {\n\t\t\treturn {\n\t\t\t\ttype: \"federation.message\",\n\t\t\t\tinstanceId: postal.instanceId(),\n\t\t\t\ttimeStamp: new Date(),\n\t\t\t\tenvelope: env\n\t\t\t};\n\t\t},\n\t\tdisconnect: function disconnect() {\n\t\t\treturn {\n\t\t\t\ttype: \"federation.disconnect\",\n\t\t\t\tinstanceId: postal.instanceId(),\n\t\t\t\ttimeStamp: new Date()\n\t\t\t};\n\t\t},\n\t\tbundle: function bundle(packingSlips) {\n\t\t\treturn {\n\t\t\t\ttype: \"federation.bundle\",\n\t\t\t\tinstanceId: postal.instanceId(),\n\t\t\t\ttimeStamp: new Date(),\n\t\t\t\tpackingSlips: packingSlips\n\t\t\t};\n\t\t}\n\t};\n\tvar handlers = {\n\t\t\"federation.ping\": function federationPing(data /*, callback */) {\n\t\t\tdata.source.setInstanceId(data.packingSlip.instanceId);\n\t\t\tif (data.source.handshakeComplete) {\n\t\t\t\tdata.source.sendPong(data.packingSlip);\n\t\t\t} else {\n\t\t\t\tdata.source.sendBundle([fedx.getPackingSlip(\"pong\", data.packingSlip), fedx.getPackingSlip(\"ping\")]);\n\t\t\t}\n\t\t},\n\t\t\"federation.pong\": function federationPong(data) {\n\t\t\tdata.source.handshakeComplete = true;\n\t\t\tdata.source.setInstanceId(data.packingSlip.instanceId);\n\t\t\tif (data.source.pings[data.packingSlip.pingData.ticket]) {\n\t\t\t\tdata.source.pings[data.packingSlip.pingData.ticket].callback({\n\t\t\t\t\tticket: data.packingSlip.pingData.ticket,\n\t\t\t\t\tinstanceId: data.packingSlip.instanceId,\n\t\t\t\t\tsource: data.source\n\t\t\t\t});\n\t\t\t\tdata.source.pings[data.packingSlip.pingData.ticket] = undefined;\n\t\t\t}\n\t\t\tif (!_.contains(fedx.clients, data.packingSlip.instanceId)) {\n\t\t\t\tfedx.clients.push(data.packingSlip.instanceId);\n\t\t\t}\n\t\t\tpostal.publish({\n\t\t\t\tchannel: \"postal.federation\",\n\t\t\t\ttopic: \"client.federated\",\n\t\t\t\tdata: {\n\t\t\t\t\tremoteId: data.source.instanceId,\n\t\t\t\t\tlocalId: postal.instanceId(),\n\t\t\t\t\ttransport: data.transport\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t\"federation.disconnect\": function federationDisconnect(data) {\n\t\t\tfedx.clients = _.without(fedx.clients, data.source.instanceId);\n\t\t\tfedx.disconnect({\n\t\t\t\ttransport: data.source.transportName,\n\t\t\t\tinstanceId: data.source.instanceId,\n\t\t\t\tdoNotNotify: true\n\t\t\t});\n\t\t},\n\t\t\"federation.message\": function federationMessage(data) {\n\t\t\tvar env = data.packingSlip.envelope;\n\t\t\tif (_matchesFilter(env.channel, env.topic, \"in\")) {\n\t\t\t\tenv.lastSender = data.packingSlip.instanceId;\n\t\t\t\tpostal.publish(env);\n\t\t\t}\n\t\t},\n\t\t\"federation.bundle\": function federationBundle(data) {\n\t\t\t_.each(data.packingSlip.packingSlips, function (slip) {\n\t\t\t\tfedx.onFederatedMsg(_.extend({}, data, {\n\t\t\t\t\tpackingSlip: slip\n\t\t\t\t}));\n\t\t\t});\n\t\t}\n\t};\n\t\n\tfunction FederationClient(target, options, instanceId) {\n\t\tthis.target = target;\n\t\tthis.options = options || {};\n\t\tthis.pings = {};\n\t\tthis.instanceId = instanceId;\n\t\tthis.handshakeComplete = false;\n\t};\n\t\n\tFederationClient.prototype.sendPing = function (callback) {\n\t\tvar packingSlip = fedx.getPackingSlip(\"ping\");\n\t\tthis.pings[packingSlip.ticket] = {\n\t\t\tticket: packingSlip.ticket,\n\t\t\tcallback: callback || NO_OP\n\t\t};\n\t\tthis.send(packingSlip);\n\t};\n\t\n\tFederationClient.prototype.sendPong = function (origPackingSlip) {\n\t\tthis.send(fedx.getPackingSlip(\"pong\", origPackingSlip));\n\t};\n\t\n\tFederationClient.prototype.sendBundle = function (slips) {\n\t\tthis.send(fedx.getPackingSlip(\"bundle\", slips));\n\t};\n\t\n\tFederationClient.prototype.sendMessage = function (envelope) {\n\t\tif (!this.handshakeComplete) {\n\t\t\treturn;\n\t\t}\n\t\tenvelope.originId = envelope.originId || postal.instanceId();\n\t\tvar env = _.clone(envelope);\n\t\tif (this.instanceId && this.instanceId !== env.lastSender && (!env.knownIds || !env.knownIds.length || env.knownIds && !_.include(env.knownIds, this.instanceId))) {\n\t\t\tenv.knownIds = (env.knownIds || []).concat(_.without(fedx.clients, this.instanceId));\n\t\t\tthis.send(fedx.getPackingSlip(\"message\", env));\n\t\t}\n\t};\n\t\n\tFederationClient.prototype.disconnect = function () {\n\t\tthis.send(fedx.getPackingSlip(\"disconnect\"));\n\t};\n\t\n\tFederationClient.prototype.onMessage = function (packingSlip) {\n\t\tif (this.shouldProcess()) {\n\t\t\tfedx.onFederatedMsg({\n\t\t\t\ttransport: this.transportName,\n\t\t\t\tpackingSlip: packingSlip,\n\t\t\t\tsource: this\n\t\t\t});\n\t\t}\n\t};\n\t\n\tFederationClient.prototype.shouldProcess = function () {\n\t\treturn true;\n\t};\n\t\n\tFederationClient.prototype.send = function () {\n\t\tthrow new Error(\"An object deriving from FederationClient must provide an implementation for 'send'.\");\n\t};\n\t\n\tFederationClient.prototype.setInstanceId = function (id) {\n\t\tthis.instanceId = id;\n\t};\n\t\n\tFederationClient.extend = function (props, ctrProps) {\n\t\tfunction FedXClient() {\n\t\t\tFederationClient.apply(this, arguments);\n\t\t}\n\t\n\t\tFedXClient.prototype = Object.create(FederationClient.prototype);\n\t\t_.extend(FedXClient.prototype, props);\n\t\t_.extend(FedXClient, ctrProps);\n\t\n\t\treturn FedXClient;\n\t};\n\t\n\tmodule.exports = fedx = postal.fedx = {\n\t\tFederationClient: FederationClient,\n\t\tpackingSlips: packingSlips,\n\t\thandlers: handlers,\n\t\tclients: [],\n\t\ttransports: {},\n\t\tfilters: {\n\t\t\t\"in\": {}, // jscs:ignore disallowQuotedKeysInObjects\n\t\t\tout: {}\n\t\t},\n\t\taddFilter: function addFilter(filters) {\n\t\t\tfilters = _.isArray(filters) ? filters : [filters];\n\t\t\t_.each(filters, function (filter) {\n\t\t\t\tfilter.direction = filter.direction || _config.filterDirection;\n\t\t\t\t_.each(filter.direction === \"both\" ? [\"in\", \"out\"] : [filter.direction], function (dir) {\n\t\t\t\t\tif (!this.filters[dir][filter.channel]) {\n\t\t\t\t\t\tthis.filters[dir][filter.channel] = [filter.topic];\n\t\t\t\t\t} else if (!_.include(this.filters[dir][filter.channel], filter.topic)) {\n\t\t\t\t\t\tthis.filters[dir][filter.channel].push(filter.topic);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}, this);\n\t\t},\n\t\tremoveFilter: function removeFilter(filters) {\n\t\t\tfilters = _.isArray(filters) ? filters : [filters];\n\t\t\t_.each(filters, function (filter) {\n\t\t\t\tfilter.direction = filter.direction || _config.filterDirection;\n\t\t\t\t_.each(filter.direction === \"both\" ? [\"in\", \"out\"] : [filter.direction], function (dir) {\n\t\t\t\t\tif (this.filters[dir][filter.channel] && _.include(this.filters[dir][filter.channel], filter.topic)) {\n\t\t\t\t\t\tthis.filters[dir][filter.channel] = _.without(this.filters[dir][filter.channel], filter.topic);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}, this);\n\t\t},\n\t\tcanSendRemote: function canSendRemote(channel, topic) {\n\t\t\treturn _matchesFilter(channel, topic, \"out\");\n\t\t},\n\t\tconfigure: function configure(cfg) {\n\t\t\tif (cfg && cfg.filterMode && cfg.filterMode !== \"blacklist\" && cfg.filterMode !== \"whitelist\") {\n\t\t\t\tthrow new Error(\"postal.fedx filterMode must be 'blacklist' or 'whitelist'.\");\n\t\t\t}\n\t\t\tif (cfg) {\n\t\t\t\t_config = _.defaults(cfg, _defaults);\n\t\t\t}\n\t\t\treturn _config;\n\t\t},\n\t\tgetPackingSlip: function getPackingSlip(type /*, env */) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(packingSlips, type)) {\n\t\t\t\treturn packingSlips[type].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\t}\n\t\t},\n\t\tonFederatedMsg: function onFederatedMsg(data) {\n\t\t\tif (!_ready) {\n\t\t\t\t_inboundQueue.push(data);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Object.prototype.hasOwnProperty.call(handlers, data.packingSlip.type)) {\n\t\t\t\thandlers[data.packingSlip.type](data);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"postal.federation does not have a message handler for '\" + data.packingSlip.type + \"'.\");\n\t\t\t}\n\t\t},\n\t\tsendMessage: function sendMessage(envelope) {\n\t\t\tif (!_ready) {\n\t\t\t\t_outboundQueue.push(arguments);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_.each(this.transports, function (transport) {\n\t\t\t\ttransport.sendMessage(envelope);\n\t\t\t});\n\t\t},\n\t\tdisconnect: function disconnect(options) {\n\t\t\toptions = options || {};\n\t\t\tvar transports = this.transports;\n\t\t\tif (options.transport) {\n\t\t\t\ttransports = {};\n\t\t\t\ttransports[options.transport] = this.transports[options.transport];\n\t\t\t}\n\t\t\t_.each(transports, function (transport) {\n\t\t\t\ttransport.disconnect({\n\t\t\t\t\ttarget: options.target,\n\t\t\t\t\tinstanceId: options.instanceId,\n\t\t\t\t\tdoNotNotify: !!options.doNotNotify\n\t\t\t\t});\n\t\t\t}, this);\n\t\t},\n\t\t_getTransports: function _getTransports() {\n\t\t\treturn _.reduce(this.transports, function (memo, transport, name) {\n\t\t\t\tmemo[name] = true;\n\t\t\t\treturn memo;\n\t\t\t}, {});\n\t\t},\n\t\t/*\n\t \tsignalReady( callback );\n\t \tsignalReady( \"transportName\" );\n\t \tsignalReady( \"transportName\", callback );\n\t \tsignalReady( \"transportName\", targetInstance, callback ); <-- this is NEW\n\t \tsignalReady( { transportNameA: targetsForA, transportNameB: targetsForB, transportC: true }, callback);\n\t */\n\t\tsignalReady: function signalReady(transport, target, callback) {\n\t\t\tif (!_ready) {\n\t\t\t\t_signalQueue.push(arguments);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar transports = this._getTransports();\n\t\t\tswitch (arguments.length) {\n\t\t\t\tcase 1:\n\t\t\t\t\tif (typeof transport === \"function\") {\n\t\t\t\t\t\tcallback = transport;\n\t\t\t\t\t} else if (typeof transport === \"string\") {\n\t\t\t\t\t\ttransports = {};\n\t\t\t\t\t\ttransports[transport] = this.transports[transport];\n\t\t\t\t\t\tcallback = NO_OP;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tif (typeof transport === \"string\") {\n\t\t\t\t\t\ttransports = {};\n\t\t\t\t\t\ttransports[transport] = this.transports[transport];\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttransports = transport;\n\t\t\t\t\t}\n\t\t\t\t\tcallback = target || NO_OP;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\ttransports = {};\n\t\t\t\t\ttransports[transport] = [target];\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t_.each(transports, function (targets, name) {\n\t\t\t\ttargets = typeof targets === \"boolean\" ? [] : targets;\n\t\t\t\tthis.transports[name].signalReady(targets, callback);\n\t\t\t}, this);\n\t\t}\n\t};\n\t\n\tfunction processSignalQ(args) {\n\t\tfedx.signalReady.apply(this, args);\n\t}\n\t\n\tfunction processOutboundQ(args) {\n\t\tfedx.send.apply(this, args);\n\t}\n\t\n\tfunction processInboundQ(msg) {\n\t\tfedx.onFederatedMsg.call(this, msg);\n\t}\n\t\n\tpostal.addWireTap(function (data, envelope) {\n\t\tif (fedx.canSendRemote(envelope.channel, envelope.topic)) {\n\t\t\tfedx.sendMessage(envelope);\n\t\t}\n\t});\n\t\n\tpostal.subscribe({\n\t\tchannel: postal.configuration.SYSTEM_CHANNEL,\n\t\ttopic: \"instanceId.changed\",\n\t\tcallback: function callback() {\n\t\t\t_ready = true;\n\t\t\twhile (_signalQueue.length) {\n\t\t\t\tprocessSignalQ(_signalQueue.shift());\n\t\t\t}\n\t\t\twhile (_outboundQueue.length) {\n\t\t\t\tprocessOutboundQ(_outboundQueue.shift());\n\t\t\t}\n\t\t\twhile (_inboundQueue.length) {\n\t\t\t\tprocessInboundQ(_inboundQueue.shift());\n\t\t\t}\n\t\t}\n\t});\n\t\n\tif (postal.instanceId() !== undefined) {\n\t\t_ready = true;\n\t}\n\t/* msg */\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA1NzE0MzIwMDFhZjkwYzRmMWVkNyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiX1wiIiwid2VicGFjazovLy9leHRlcm5hbCBcInBvc3RhbFwiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsTztBQ1ZBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7O0tDdENPLENBQUMsdUNBQU0sQ0FBUTs7S0FDZixNQUFNLHVDQUFNLENBQVE7O0FBRTNCLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxFQUFHO0FBQ3pCLFFBQU0sQ0FBQyxVQUFVLEdBQUcsWUFBVztBQUM5QixPQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDWCxPQUFNLFNBQVMsR0FBRyxrQkFBa0IsQ0FBQztBQUNyQyxRQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFHO0FBQzlCLEtBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFFLElBQUksQ0FBQyxLQUFLLENBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUksQ0FBRSxFQUFFLENBQUMsQ0FBRSxDQUFDO0lBQ2pFO0FBQ0QsSUFBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsQ0FBQzs7QUFFWixJQUFD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QUFDL0Isb0JBQWdCLENBQUUsY0FBYyxDQUFDLEtBQUssRUFBRSxDQUFFLENBQUM7SUFDM0M7QUFDRCxVQUFRLGFBQWEsQ0FBQyxNQUFNLEVBQUc7QUFDOUIsbUJBQWUsQ0FBRSxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUUsQ0FBQztJQUN6QztHQUNEO0VBQ0QsQ0FBRSxDQUFDOztBQUVKLEtBQUssTUFBTSxDQUFDLFVBQVUsRUFBRSxLQUFLLFNBQVMsRUFBRztBQUN4QyxRQUFNLEdBQUcsSUFBSSxDQUFDO0VBQ2Q7Ozs7Ozs7QUMvWkQsZ0Q7Ozs7OztBQ0FBLGdEIiwiZmlsZSI6InBvc3RhbC5mZWRlcmF0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwiX1wiKSwgcmVxdWlyZShcInBvc3RhbFwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJfXCIsIFwicG9zdGFsXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInBvc3RhbEZlZHhcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJfXCIpLCByZXF1aXJlKFwicG9zdGFsXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJwb3N0YWxGZWR4XCJdID0gZmFjdG9yeShyb290W1wiX1wiXSwgcm9vdFtcInBvc3RhbFwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX18pIHtcbnJldHVybiBcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb25cbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDU3MTQzMjAwMWFmOTBjNGYxZWQ3XG4gKiovIiwiaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0IHBvc3RhbCBmcm9tIFwicG9zdGFsXCI7XG5cbmlmICggIXBvc3RhbC5jcmVhdGVVVUlEICkge1xuXHRwb3N0YWwuY3JlYXRlVVVJRCA9IGZ1bmN0aW9uKCkge1xuXHRcdGxldCBzID0gW107XG5cdFx0Y29uc3QgaGV4RGlnaXRzID0gXCIwMTIzNDU2Nzg5YWJjZGVmXCI7XG5cdFx0Zm9yICggbGV0IGkgPSAwOyBpIDwgMzY7IGkrKyApIHtcblx0XHRcdHNbaV0gPSBoZXhEaWdpdHMuc3Vic3RyKCBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogMHgxMCApLCAxICk7XG5cdFx0fVxuXHRcdHNbMTRdID0gXCI0XCI7IC8vIGJpdHMgMTItMTUgb2YgdGhlIHRpbWVfaGlfYW5kX3ZlcnNpb24gZmllbGQgdG8gMDAxMFxuXHRcdC8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cblx0XHRzWzE5XSA9IGhleERpZ2l0cy5zdWJzdHIoICggc1sxOV0gJiAweDMgKSB8IDB4OCwgMSApOyAvLyBiaXRzIDYtNyBvZiB0aGUgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZCB0byAwMVxuXHRcdC8qIGpzaGludCBpZ25vcmU6ZW5kICovXG5cdFx0c1s4XSA9IHNbMTNdID0gc1sxOF0gPSBzWzIzXSA9IFwiLVwiO1xuXHRcdHJldHVybiBzLmpvaW4oIFwiXCIgKTtcblx0fTtcbn1cbmlmICggIXBvc3RhbC5pbnN0YW5jZUlkICkge1xuXHRwb3N0YWwuaW5zdGFuY2VJZCA9ICggZnVuY3Rpb24oKSB7XG5cdFx0bGV0IF9pZCwgX29sZElkO1xuXHRcdHJldHVybiBmdW5jdGlvbiggaWQgKSB7XG5cdFx0XHRpZiAoIGlkICkge1xuXHRcdFx0XHRfb2xkSWQgPSBfaWQ7XG5cdFx0XHRcdF9pZCA9IGlkO1xuXHRcdFx0XHRwb3N0YWwucHVibGlzaCgge1xuXHRcdFx0XHRcdGNoYW5uZWw6IHBvc3RhbC5jb25maWd1cmF0aW9uLlNZU1RFTV9DSEFOTkVMLFxuXHRcdFx0XHRcdHRvcGljOiBcImluc3RhbmNlSWQuY2hhbmdlZFwiLFxuXHRcdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRcdG9sZElkOiBfb2xkSWQsXG5cdFx0XHRcdFx0XHRuZXdJZDogX2lkXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ICk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gX2lkO1xuXHRcdH07XG5cdH0oKSApO1xufVxuXG5jb25zdCBOT19PUCA9IGZ1bmN0aW9uKCkge307XG5sZXQgX3JlYWR5ID0gZmFsc2U7XG5sZXQgX2luYm91bmRRdWV1ZSA9IFtdO1xubGV0IF9vdXRib3VuZFF1ZXVlID0gW107XG5sZXQgX3NpZ25hbFF1ZXVlID0gW107XG5jb25zdCBfZGVmYXVsdHMgPSB7XG5cdGVuYWJsZWQ6IHRydWUsXG5cdGZpbHRlck1vZGU6IFwid2hpdGVsaXN0XCIsXG5cdGZpbHRlckRpcmVjdGlvbjogXCJib3RoXCJcbn07XG5sZXQgX2NvbmZpZyA9IF9kZWZhdWx0cztcbmZ1bmN0aW9uIF9tYXRjaGVzRmlsdGVyKCBjaGFubmVsLCB0b3BpYywgZGlyZWN0aW9uICkge1xuXHRjb25zdCBjaGFubmVsUHJlc2VudCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCggZmVkeC5maWx0ZXJzW2RpcmVjdGlvbl0sIGNoYW5uZWwgKTtcblx0Y29uc3QgdG9waWNNYXRjaCA9ICggY2hhbm5lbFByZXNlbnQgJiYgXy5hbnkoIGZlZHguZmlsdGVyc1tkaXJlY3Rpb25dW2NoYW5uZWxdLCBmdW5jdGlvbiggYmluZGluZyApIHtcblx0XHRyZXR1cm4gcG9zdGFsLmNvbmZpZ3VyYXRpb24ucmVzb2x2ZXIuY29tcGFyZSggYmluZGluZywgdG9waWMgKTtcblx0fSApICk7XG5cdGNvbnN0IGJsYWNrbGlzdGluZyA9IF9jb25maWcuZmlsdGVyTW9kZSA9PT0gXCJibGFja2xpc3RcIjtcblx0cmV0dXJuIF9jb25maWcuZW5hYmxlZCAmJiAoICggYmxhY2tsaXN0aW5nICYmICggIWNoYW5uZWxQcmVzZW50IHx8ICggY2hhbm5lbFByZXNlbnQgJiYgIXRvcGljTWF0Y2ggKSApICkgfHwgKCAhYmxhY2tsaXN0aW5nICYmIGNoYW5uZWxQcmVzZW50ICYmIHRvcGljTWF0Y2ggKSApO1xufTtcblxuY29uc3QgcGFja2luZ1NsaXBzID0ge1xuXHRwaW5nOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZTogXCJmZWRlcmF0aW9uLnBpbmdcIixcblx0XHRcdGluc3RhbmNlSWQ6IHBvc3RhbC5pbnN0YW5jZUlkKCksXG5cdFx0XHR0aW1lU3RhbXA6IG5ldyBEYXRlKCksXG5cdFx0XHR0aWNrZXQ6IHBvc3RhbC5jcmVhdGVVVUlEKClcblx0XHR9O1xuXHR9LFxuXHRwb25nOiBmdW5jdGlvbiggcGluZyApIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZTogXCJmZWRlcmF0aW9uLnBvbmdcIixcblx0XHRcdGluc3RhbmNlSWQ6IHBvc3RhbC5pbnN0YW5jZUlkKCksXG5cdFx0XHR0aW1lU3RhbXA6IG5ldyBEYXRlKCksXG5cdFx0XHRwaW5nRGF0YToge1xuXHRcdFx0XHRpbnN0YW5jZUlkOiBwaW5nLmluc3RhbmNlSWQsXG5cdFx0XHRcdHRpbWVTdGFtcDogcGluZy50aW1lU3RhbXAsXG5cdFx0XHRcdHRpY2tldDogcGluZy50aWNrZXRcblx0XHRcdH1cblx0XHR9O1xuXHR9LFxuXHRtZXNzYWdlOiBmdW5jdGlvbiggZW52ICkge1xuXHRcdHJldHVybiB7XG5cdFx0XHR0eXBlOiBcImZlZGVyYXRpb24ubWVzc2FnZVwiLFxuXHRcdFx0aW5zdGFuY2VJZDogcG9zdGFsLmluc3RhbmNlSWQoKSxcblx0XHRcdHRpbWVTdGFtcDogbmV3IERhdGUoKSxcblx0XHRcdGVudmVsb3BlOiBlbnZcblx0XHR9O1xuXHR9LFxuXHRkaXNjb25uZWN0OiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dHlwZTogXCJmZWRlcmF0aW9uLmRpc2Nvbm5lY3RcIixcblx0XHRcdGluc3RhbmNlSWQ6IHBvc3RhbC5pbnN0YW5jZUlkKCksXG5cdFx0XHR0aW1lU3RhbXA6IG5ldyBEYXRlKClcblx0XHR9O1xuXHR9LFxuXHRidW5kbGU6IGZ1bmN0aW9uKCBwYWNraW5nU2xpcHMgKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHR5cGU6IFwiZmVkZXJhdGlvbi5idW5kbGVcIixcblx0XHRcdGluc3RhbmNlSWQ6IHBvc3RhbC5pbnN0YW5jZUlkKCksXG5cdFx0XHR0aW1lU3RhbXA6IG5ldyBEYXRlKCksXG5cdFx0XHRwYWNraW5nU2xpcHM6IHBhY2tpbmdTbGlwc1xuXHRcdH07XG5cdH1cbn07XG5jb25zdCBoYW5kbGVycyA9IHtcblx0XCJmZWRlcmF0aW9uLnBpbmdcIjogZnVuY3Rpb24oIGRhdGEgLyosIGNhbGxiYWNrICovICkge1xuXHRcdGRhdGEuc291cmNlLnNldEluc3RhbmNlSWQoIGRhdGEucGFja2luZ1NsaXAuaW5zdGFuY2VJZCApO1xuXHRcdGlmICggZGF0YS5zb3VyY2UuaGFuZHNoYWtlQ29tcGxldGUgKSB7XG5cdFx0XHRkYXRhLnNvdXJjZS5zZW5kUG9uZyggZGF0YS5wYWNraW5nU2xpcCApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkYXRhLnNvdXJjZS5zZW5kQnVuZGxlKCBbXG5cdFx0XHRmZWR4LmdldFBhY2tpbmdTbGlwKCBcInBvbmdcIiwgZGF0YS5wYWNraW5nU2xpcCApLFxuXHRcdFx0ZmVkeC5nZXRQYWNraW5nU2xpcCggXCJwaW5nXCIgKVxuXHRcdFx0XSApO1xuXHRcdH1cblx0fSxcblx0XCJmZWRlcmF0aW9uLnBvbmdcIjogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0ZGF0YS5zb3VyY2UuaGFuZHNoYWtlQ29tcGxldGUgPSB0cnVlO1xuXHRcdGRhdGEuc291cmNlLnNldEluc3RhbmNlSWQoIGRhdGEucGFja2luZ1NsaXAuaW5zdGFuY2VJZCApO1xuXHRcdGlmICggZGF0YS5zb3VyY2UucGluZ3NbZGF0YS5wYWNraW5nU2xpcC5waW5nRGF0YS50aWNrZXRdICkge1xuXHRcdFx0ZGF0YS5zb3VyY2UucGluZ3NbZGF0YS5wYWNraW5nU2xpcC5waW5nRGF0YS50aWNrZXRdLmNhbGxiYWNrKCB7XG5cdFx0XHRcdHRpY2tldDogZGF0YS5wYWNraW5nU2xpcC5waW5nRGF0YS50aWNrZXQsXG5cdFx0XHRcdGluc3RhbmNlSWQ6IGRhdGEucGFja2luZ1NsaXAuaW5zdGFuY2VJZCxcblx0XHRcdFx0c291cmNlOiBkYXRhLnNvdXJjZVxuXHRcdFx0fSApO1xuXHRcdFx0ZGF0YS5zb3VyY2UucGluZ3NbZGF0YS5wYWNraW5nU2xpcC5waW5nRGF0YS50aWNrZXRdID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHRpZiAoICFfLmNvbnRhaW5zKCBmZWR4LmNsaWVudHMsIGRhdGEucGFja2luZ1NsaXAuaW5zdGFuY2VJZCApICkge1xuXHRcdFx0ZmVkeC5jbGllbnRzLnB1c2goIGRhdGEucGFja2luZ1NsaXAuaW5zdGFuY2VJZCApO1xuXHRcdH1cblx0XHRwb3N0YWwucHVibGlzaCgge1xuXHRcdFx0Y2hhbm5lbDogXCJwb3N0YWwuZmVkZXJhdGlvblwiLFxuXHRcdFx0dG9waWM6IFwiY2xpZW50LmZlZGVyYXRlZFwiLFxuXHRcdFx0ZGF0YToge1xuXHRcdFx0XHRyZW1vdGVJZDogZGF0YS5zb3VyY2UuaW5zdGFuY2VJZCxcblx0XHRcdFx0bG9jYWxJZDogcG9zdGFsLmluc3RhbmNlSWQoKSxcblx0XHRcdFx0dHJhbnNwb3J0OiBkYXRhLnRyYW5zcG9ydFxuXHRcdFx0fVxuXHRcdH0gKTtcblx0fSxcblx0XCJmZWRlcmF0aW9uLmRpc2Nvbm5lY3RcIjogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0ZmVkeC5jbGllbnRzID0gXy53aXRob3V0KCBmZWR4LmNsaWVudHMsIGRhdGEuc291cmNlLmluc3RhbmNlSWQgKTtcblx0XHRmZWR4LmRpc2Nvbm5lY3QoIHtcblx0XHRcdHRyYW5zcG9ydDogZGF0YS5zb3VyY2UudHJhbnNwb3J0TmFtZSxcblx0XHRcdGluc3RhbmNlSWQ6IGRhdGEuc291cmNlLmluc3RhbmNlSWQsXG5cdFx0XHRkb05vdE5vdGlmeTogdHJ1ZVxuXHRcdH0gKTtcblx0fSxcblx0XCJmZWRlcmF0aW9uLm1lc3NhZ2VcIjogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0Y29uc3QgZW52ID0gZGF0YS5wYWNraW5nU2xpcC5lbnZlbG9wZTtcblx0XHRpZiAoIF9tYXRjaGVzRmlsdGVyKCBlbnYuY2hhbm5lbCwgZW52LnRvcGljLCBcImluXCIgKSApIHtcblx0XHRcdGVudi5sYXN0U2VuZGVyID0gZGF0YS5wYWNraW5nU2xpcC5pbnN0YW5jZUlkO1xuXHRcdFx0cG9zdGFsLnB1Ymxpc2goIGVudiApO1xuXHRcdH1cblx0fSxcblx0XCJmZWRlcmF0aW9uLmJ1bmRsZVwiOiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHRfLmVhY2goIGRhdGEucGFja2luZ1NsaXAucGFja2luZ1NsaXBzLCBmdW5jdGlvbiggc2xpcCApIHtcblx0XHRcdGZlZHgub25GZWRlcmF0ZWRNc2coIF8uZXh0ZW5kKCB7fSwgZGF0YSwge1xuXHRcdFx0XHRwYWNraW5nU2xpcDogc2xpcFxuXHRcdFx0fSApICk7XG5cdFx0fSApO1xuXHR9XG59O1xuXG5mdW5jdGlvbiBGZWRlcmF0aW9uQ2xpZW50KCB0YXJnZXQsIG9wdGlvbnMsIGluc3RhbmNlSWQgKSB7XG5cdHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuXHR0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHR0aGlzLnBpbmdzID0ge307XG5cdHRoaXMuaW5zdGFuY2VJZCA9IGluc3RhbmNlSWQ7XG5cdHRoaXMuaGFuZHNoYWtlQ29tcGxldGUgPSBmYWxzZTtcbn07XG5cbkZlZGVyYXRpb25DbGllbnQucHJvdG90eXBlLnNlbmRQaW5nID0gZnVuY3Rpb24oIGNhbGxiYWNrICkge1xuXHRjb25zdCBwYWNraW5nU2xpcCA9IGZlZHguZ2V0UGFja2luZ1NsaXAoIFwicGluZ1wiICk7XG5cdHRoaXMucGluZ3NbcGFja2luZ1NsaXAudGlja2V0XSA9IHtcblx0XHR0aWNrZXQ6IHBhY2tpbmdTbGlwLnRpY2tldCxcblx0XHRjYWxsYmFjazogY2FsbGJhY2sgfHwgTk9fT1Bcblx0fTtcblx0dGhpcy5zZW5kKCBwYWNraW5nU2xpcCApO1xufTtcblxuRmVkZXJhdGlvbkNsaWVudC5wcm90b3R5cGUuc2VuZFBvbmcgPSBmdW5jdGlvbiggb3JpZ1BhY2tpbmdTbGlwICkge1xuXHR0aGlzLnNlbmQoIGZlZHguZ2V0UGFja2luZ1NsaXAoIFwicG9uZ1wiLCBvcmlnUGFja2luZ1NsaXAgKSApO1xufTtcblxuRmVkZXJhdGlvbkNsaWVudC5wcm90b3R5cGUuc2VuZEJ1bmRsZSA9IGZ1bmN0aW9uKCBzbGlwcyApIHtcblx0dGhpcy5zZW5kKCBmZWR4LmdldFBhY2tpbmdTbGlwKCBcImJ1bmRsZVwiLCBzbGlwcyApICk7XG59O1xuXG5GZWRlcmF0aW9uQ2xpZW50LnByb3RvdHlwZS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uKCBlbnZlbG9wZSApIHtcblx0aWYgKCAhdGhpcy5oYW5kc2hha2VDb21wbGV0ZSApIHtcblx0XHRyZXR1cm47XG5cdH1cblx0ZW52ZWxvcGUub3JpZ2luSWQgPSBlbnZlbG9wZS5vcmlnaW5JZCB8fCBwb3N0YWwuaW5zdGFuY2VJZCgpO1xuXHRjb25zdCBlbnYgPSBfLmNsb25lKCBlbnZlbG9wZSApO1xuXHRpZiAoIHRoaXMuaW5zdGFuY2VJZCAmJiB0aGlzLmluc3RhbmNlSWQgIT09IGVudi5sYXN0U2VuZGVyICYmXG5cdCggIWVudi5rbm93bklkcyB8fCAhZW52Lmtub3duSWRzLmxlbmd0aCB8fFxuXHQoIGVudi5rbm93bklkcyAmJiAhXy5pbmNsdWRlKCBlbnYua25vd25JZHMsIHRoaXMuaW5zdGFuY2VJZCApICkgKVxuXHQpIHtcblx0XHRlbnYua25vd25JZHMgPSAoIGVudi5rbm93bklkcyB8fCBbXSApLmNvbmNhdCggXy53aXRob3V0KCBmZWR4LmNsaWVudHMsIHRoaXMuaW5zdGFuY2VJZCApICk7XG5cdFx0dGhpcy5zZW5kKCBmZWR4LmdldFBhY2tpbmdTbGlwKCBcIm1lc3NhZ2VcIiwgZW52ICkgKTtcblx0fVxufTtcblxuRmVkZXJhdGlvbkNsaWVudC5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLnNlbmQoIGZlZHguZ2V0UGFja2luZ1NsaXAoIFwiZGlzY29ubmVjdFwiICkgKTtcbn07XG5cbkZlZGVyYXRpb25DbGllbnQucHJvdG90eXBlLm9uTWVzc2FnZSA9IGZ1bmN0aW9uKCBwYWNraW5nU2xpcCApIHtcblx0aWYgKCB0aGlzLnNob3VsZFByb2Nlc3MoKSApIHtcblx0XHRmZWR4Lm9uRmVkZXJhdGVkTXNnKCB7XG5cdFx0XHR0cmFuc3BvcnQ6IHRoaXMudHJhbnNwb3J0TmFtZSxcblx0XHRcdHBhY2tpbmdTbGlwOiBwYWNraW5nU2xpcCxcblx0XHRcdHNvdXJjZTogdGhpc1xuXHRcdH0gKTtcblx0fVxufTtcblxuRmVkZXJhdGlvbkNsaWVudC5wcm90b3R5cGUuc2hvdWxkUHJvY2VzcyA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cbkZlZGVyYXRpb25DbGllbnQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiggLyogbXNnICovICkge1xuXHR0aHJvdyBuZXcgRXJyb3IoIFwiQW4gb2JqZWN0IGRlcml2aW5nIGZyb20gRmVkZXJhdGlvbkNsaWVudCBtdXN0IHByb3ZpZGUgYW4gaW1wbGVtZW50YXRpb24gZm9yICdzZW5kJy5cIiApO1xufTtcblxuRmVkZXJhdGlvbkNsaWVudC5wcm90b3R5cGUuc2V0SW5zdGFuY2VJZCA9IGZ1bmN0aW9uKCBpZCApIHtcblx0dGhpcy5pbnN0YW5jZUlkID0gaWQ7XG59O1xuXG5GZWRlcmF0aW9uQ2xpZW50LmV4dGVuZCA9IGZ1bmN0aW9uKCBwcm9wcywgY3RyUHJvcHMgKSB7XG5cdGZ1bmN0aW9uIEZlZFhDbGllbnQoKSB7XG5cdFx0RmVkZXJhdGlvbkNsaWVudC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG5cdH1cblxuXHRGZWRYQ2xpZW50LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEZlZGVyYXRpb25DbGllbnQucHJvdG90eXBlICk7XG5cdF8uZXh0ZW5kKCBGZWRYQ2xpZW50LnByb3RvdHlwZSwgcHJvcHMgKTtcblx0Xy5leHRlbmQoIEZlZFhDbGllbnQsIGN0clByb3BzICk7XG5cblx0cmV0dXJuIEZlZFhDbGllbnQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmZWR4ID0gcG9zdGFsLmZlZHggPSB7XG5cdEZlZGVyYXRpb25DbGllbnQ6IEZlZGVyYXRpb25DbGllbnQsXG5cdHBhY2tpbmdTbGlwczogcGFja2luZ1NsaXBzLFxuXHRoYW5kbGVyczogaGFuZGxlcnMsXG5cdGNsaWVudHM6IFtdLFxuXHR0cmFuc3BvcnRzOiB7fSxcblx0ZmlsdGVyczoge1xuXHRcdFwiaW5cIjoge30sIC8vIGpzY3M6aWdub3JlIGRpc2FsbG93UXVvdGVkS2V5c0luT2JqZWN0c1xuXHRcdG91dDoge31cblx0fSxcblx0YWRkRmlsdGVyOiBmdW5jdGlvbiggZmlsdGVycyApIHtcblx0XHRmaWx0ZXJzID0gXy5pc0FycmF5KCBmaWx0ZXJzICkgPyBmaWx0ZXJzIDogWyBmaWx0ZXJzIF07XG5cdFx0Xy5lYWNoKCBmaWx0ZXJzLCBmdW5jdGlvbiggZmlsdGVyICkge1xuXHRcdFx0ZmlsdGVyLmRpcmVjdGlvbiA9IGZpbHRlci5kaXJlY3Rpb24gfHwgX2NvbmZpZy5maWx0ZXJEaXJlY3Rpb247XG5cdFx0XHRfLmVhY2goICggZmlsdGVyLmRpcmVjdGlvbiA9PT0gXCJib3RoXCIgKSA/IFsgXCJpblwiLCBcIm91dFwiIF0gOiBbIGZpbHRlci5kaXJlY3Rpb24gXSwgZnVuY3Rpb24oIGRpciApIHtcblx0XHRcdFx0aWYgKCAhdGhpcy5maWx0ZXJzW2Rpcl1bZmlsdGVyLmNoYW5uZWxdICkge1xuXHRcdFx0XHRcdHRoaXMuZmlsdGVyc1tkaXJdW2ZpbHRlci5jaGFubmVsXSA9IFsgZmlsdGVyLnRvcGljIF07XG5cdFx0XHRcdH0gZWxzZSBpZiAoICEoIF8uaW5jbHVkZSggdGhpcy5maWx0ZXJzW2Rpcl1bZmlsdGVyLmNoYW5uZWxdLCBmaWx0ZXIudG9waWMgKSApICkge1xuXHRcdFx0XHRcdHRoaXMuZmlsdGVyc1tkaXJdW2ZpbHRlci5jaGFubmVsXS5wdXNoKCBmaWx0ZXIudG9waWMgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdGhpcyApO1xuXHRcdH0sIHRoaXMgKTtcblx0fSxcblx0cmVtb3ZlRmlsdGVyOiBmdW5jdGlvbiggZmlsdGVycyApIHtcblx0XHRmaWx0ZXJzID0gXy5pc0FycmF5KCBmaWx0ZXJzICkgPyBmaWx0ZXJzIDogWyBmaWx0ZXJzIF07XG5cdFx0Xy5lYWNoKCBmaWx0ZXJzLCBmdW5jdGlvbiggZmlsdGVyICkge1xuXHRcdFx0ZmlsdGVyLmRpcmVjdGlvbiA9IGZpbHRlci5kaXJlY3Rpb24gfHwgX2NvbmZpZy5maWx0ZXJEaXJlY3Rpb247XG5cdFx0XHRfLmVhY2goICggZmlsdGVyLmRpcmVjdGlvbiA9PT0gXCJib3RoXCIgKSA/IFsgXCJpblwiLCBcIm91dFwiIF0gOiBbIGZpbHRlci5kaXJlY3Rpb24gXSwgZnVuY3Rpb24oIGRpciApIHtcblx0XHRcdFx0aWYgKCB0aGlzLmZpbHRlcnNbZGlyXVtmaWx0ZXIuY2hhbm5lbF0gJiYgXy5pbmNsdWRlKCB0aGlzLmZpbHRlcnNbZGlyXVtmaWx0ZXIuY2hhbm5lbF0sIGZpbHRlci50b3BpYyApICkge1xuXHRcdFx0XHRcdHRoaXMuZmlsdGVyc1tkaXJdW2ZpbHRlci5jaGFubmVsXSA9IF8ud2l0aG91dCggdGhpcy5maWx0ZXJzW2Rpcl1bZmlsdGVyLmNoYW5uZWxdLCBmaWx0ZXIudG9waWMgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdGhpcyApO1xuXHRcdH0sIHRoaXMgKTtcblx0fSxcblx0Y2FuU2VuZFJlbW90ZTogZnVuY3Rpb24oIGNoYW5uZWwsIHRvcGljICkge1xuXHRcdHJldHVybiBfbWF0Y2hlc0ZpbHRlciggY2hhbm5lbCwgdG9waWMsIFwib3V0XCIgKTtcblx0fSxcblx0Y29uZmlndXJlOiBmdW5jdGlvbiggY2ZnICkge1xuXHRcdGlmICggY2ZnICYmIGNmZy5maWx0ZXJNb2RlICYmIGNmZy5maWx0ZXJNb2RlICE9PSBcImJsYWNrbGlzdFwiICYmIGNmZy5maWx0ZXJNb2RlICE9PSBcIndoaXRlbGlzdFwiICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcInBvc3RhbC5mZWR4IGZpbHRlck1vZGUgbXVzdCBiZSAnYmxhY2tsaXN0JyBvciAnd2hpdGVsaXN0Jy5cIiApO1xuXHRcdH1cblx0XHRpZiAoIGNmZyApIHtcblx0XHRcdF9jb25maWcgPSBfLmRlZmF1bHRzKCBjZmcsIF9kZWZhdWx0cyApO1xuXHRcdH1cblx0XHRyZXR1cm4gX2NvbmZpZztcblx0fSxcblx0Z2V0UGFja2luZ1NsaXA6IGZ1bmN0aW9uKCB0eXBlIC8qLCBlbnYgKi8gKSB7XG5cdFx0aWYgKCBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoIHBhY2tpbmdTbGlwcywgdHlwZSApICkge1xuXHRcdFx0cmV0dXJuIHBhY2tpbmdTbGlwc1t0eXBlXS5hcHBseSggdGhpcywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApICk7XG5cdFx0fVxuXHR9LFxuXHRvbkZlZGVyYXRlZE1zZzogZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0aWYgKCAhX3JlYWR5ICkge1xuXHRcdFx0X2luYm91bmRRdWV1ZS5wdXNoKCBkYXRhICk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICggT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKCBoYW5kbGVycywgZGF0YS5wYWNraW5nU2xpcC50eXBlICkgKSB7XG5cdFx0XHRoYW5kbGVyc1tkYXRhLnBhY2tpbmdTbGlwLnR5cGVdKCBkYXRhICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBFcnJvciggXCJwb3N0YWwuZmVkZXJhdGlvbiBkb2VzIG5vdCBoYXZlIGEgbWVzc2FnZSBoYW5kbGVyIGZvciAnXCIgKyBkYXRhLnBhY2tpbmdTbGlwLnR5cGUgKyBcIicuXCIgKTtcblx0XHR9XG5cdH0sXG5cdHNlbmRNZXNzYWdlOiBmdW5jdGlvbiggZW52ZWxvcGUgKSB7XG5cdFx0aWYgKCAhX3JlYWR5ICkge1xuXHRcdFx0X291dGJvdW5kUXVldWUucHVzaCggYXJndW1lbnRzICk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdF8uZWFjaCggdGhpcy50cmFuc3BvcnRzLCBmdW5jdGlvbiggdHJhbnNwb3J0ICkge1xuXHRcdFx0dHJhbnNwb3J0LnNlbmRNZXNzYWdlKCBlbnZlbG9wZSApO1xuXHRcdH0gKTtcblx0fSxcblx0ZGlzY29ubmVjdDogZnVuY3Rpb24oIG9wdGlvbnMgKSB7XG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0bGV0IHRyYW5zcG9ydHMgPSB0aGlzLnRyYW5zcG9ydHM7XG5cdFx0aWYgKCBvcHRpb25zLnRyYW5zcG9ydCApIHtcblx0XHRcdHRyYW5zcG9ydHMgPSB7fTtcblx0XHRcdHRyYW5zcG9ydHNbb3B0aW9ucy50cmFuc3BvcnRdID0gdGhpcy50cmFuc3BvcnRzW29wdGlvbnMudHJhbnNwb3J0XTtcblx0XHR9XG5cdFx0Xy5lYWNoKCB0cmFuc3BvcnRzLCBmdW5jdGlvbiggdHJhbnNwb3J0ICkge1xuXHRcdFx0dHJhbnNwb3J0LmRpc2Nvbm5lY3QoIHtcblx0XHRcdFx0dGFyZ2V0OiBvcHRpb25zLnRhcmdldCxcblx0XHRcdFx0aW5zdGFuY2VJZDogb3B0aW9ucy5pbnN0YW5jZUlkLFxuXHRcdFx0XHRkb05vdE5vdGlmeTogISFvcHRpb25zLmRvTm90Tm90aWZ5XG5cdFx0XHR9ICk7XG5cdFx0fSwgdGhpcyApO1xuXHR9LFxuXHRfZ2V0VHJhbnNwb3J0czogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIF8ucmVkdWNlKCB0aGlzLnRyYW5zcG9ydHMsIGZ1bmN0aW9uKCBtZW1vLCB0cmFuc3BvcnQsIG5hbWUgKSB7XG5cdFx0XHRtZW1vW25hbWVdID0gdHJ1ZTtcblx0XHRcdHJldHVybiBtZW1vO1xuXHRcdH0sIHt9ICk7XG5cdH0sXG5cdC8qXG5cdFx0c2lnbmFsUmVhZHkoIGNhbGxiYWNrICk7XG5cdFx0c2lnbmFsUmVhZHkoIFwidHJhbnNwb3J0TmFtZVwiICk7XG5cdFx0c2lnbmFsUmVhZHkoIFwidHJhbnNwb3J0TmFtZVwiLCBjYWxsYmFjayApO1xuXHRcdHNpZ25hbFJlYWR5KCBcInRyYW5zcG9ydE5hbWVcIiwgdGFyZ2V0SW5zdGFuY2UsIGNhbGxiYWNrICk7IDwtLSB0aGlzIGlzIE5FV1xuXHRcdHNpZ25hbFJlYWR5KCB7IHRyYW5zcG9ydE5hbWVBOiB0YXJnZXRzRm9yQSwgdHJhbnNwb3J0TmFtZUI6IHRhcmdldHNGb3JCLCB0cmFuc3BvcnRDOiB0cnVlIH0sIGNhbGxiYWNrKTtcblx0Ki9cblx0c2lnbmFsUmVhZHk6IGZ1bmN0aW9uKCB0cmFuc3BvcnQsIHRhcmdldCwgY2FsbGJhY2sgKSB7XG5cdFx0aWYgKCAhX3JlYWR5ICkge1xuXHRcdFx0X3NpZ25hbFF1ZXVlLnB1c2goIGFyZ3VtZW50cyApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRsZXQgdHJhbnNwb3J0cyA9IHRoaXMuX2dldFRyYW5zcG9ydHMoKTtcblx0XHRzd2l0Y2ggKCBhcmd1bWVudHMubGVuZ3RoICkge1xuXHRcdGNhc2UgMTpcblx0XHRcdGlmICggdHlwZW9mIHRyYW5zcG9ydCA9PT0gXCJmdW5jdGlvblwiICkge1xuXHRcdFx0XHRjYWxsYmFjayA9IHRyYW5zcG9ydDtcblx0XHRcdH0gZWxzZSBpZiAoIHR5cGVvZiB0cmFuc3BvcnQgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdHRyYW5zcG9ydHMgPSB7fTtcblx0XHRcdFx0dHJhbnNwb3J0c1t0cmFuc3BvcnRdID0gdGhpcy50cmFuc3BvcnRzW3RyYW5zcG9ydF07XG5cdFx0XHRcdGNhbGxiYWNrID0gTk9fT1A7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIDI6XG5cdFx0XHRpZiAoIHR5cGVvZiB0cmFuc3BvcnQgPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0XHRcdHRyYW5zcG9ydHMgPSB7fTtcblx0XHRcdFx0dHJhbnNwb3J0c1t0cmFuc3BvcnRdID0gdGhpcy50cmFuc3BvcnRzW3RyYW5zcG9ydF07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0cmFuc3BvcnRzID0gdHJhbnNwb3J0O1xuXHRcdFx0fVxuXHRcdFx0Y2FsbGJhY2sgPSB0YXJnZXQgfHwgTk9fT1A7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIDM6XG5cdFx0XHR0cmFuc3BvcnRzID0ge307XG5cdFx0XHR0cmFuc3BvcnRzW3RyYW5zcG9ydF0gPSBbIHRhcmdldCBdO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdF8uZWFjaCggdHJhbnNwb3J0cywgZnVuY3Rpb24oIHRhcmdldHMsIG5hbWUgKSB7XG5cdFx0XHR0YXJnZXRzID0gdHlwZW9mIHRhcmdldHMgPT09IFwiYm9vbGVhblwiID8gW10gOiB0YXJnZXRzO1xuXHRcdFx0dGhpcy50cmFuc3BvcnRzW25hbWVdLnNpZ25hbFJlYWR5KCB0YXJnZXRzLCBjYWxsYmFjayApO1xuXHRcdH0sIHRoaXMgKTtcblx0fVxufTtcblxuZnVuY3Rpb24gcHJvY2Vzc1NpZ25hbFEoIGFyZ3MgKSB7XG5cdGZlZHguc2lnbmFsUmVhZHkuYXBwbHkoIHRoaXMsIGFyZ3MgKTtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc091dGJvdW5kUSggYXJncyApIHtcblx0ZmVkeC5zZW5kLmFwcGx5KCB0aGlzLCBhcmdzICk7XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NJbmJvdW5kUSggbXNnICkge1xuXHRmZWR4Lm9uRmVkZXJhdGVkTXNnLmNhbGwoIHRoaXMsIG1zZyApO1xufVxuXG5wb3N0YWwuYWRkV2lyZVRhcCggZnVuY3Rpb24oIGRhdGEsIGVudmVsb3BlICkge1xuXHRpZiAoIGZlZHguY2FuU2VuZFJlbW90ZSggZW52ZWxvcGUuY2hhbm5lbCwgZW52ZWxvcGUudG9waWMgKSApIHtcblx0XHRmZWR4LnNlbmRNZXNzYWdlKCBlbnZlbG9wZSApO1xuXHR9XG59ICk7XG5cbnBvc3RhbC5zdWJzY3JpYmUoIHtcblx0Y2hhbm5lbDogcG9zdGFsLmNvbmZpZ3VyYXRpb24uU1lTVEVNX0NIQU5ORUwsXG5cdHRvcGljOiBcImluc3RhbmNlSWQuY2hhbmdlZFwiLFxuXHRjYWxsYmFjazogZnVuY3Rpb24oKSB7XG5cdFx0X3JlYWR5ID0gdHJ1ZTtcblx0XHR3aGlsZSAoIF9zaWduYWxRdWV1ZS5sZW5ndGggKSB7XG5cdFx0XHRwcm9jZXNzU2lnbmFsUSggX3NpZ25hbFF1ZXVlLnNoaWZ0KCkgKTtcblx0XHR9XG5cdFx0d2hpbGUgKCBfb3V0Ym91bmRRdWV1ZS5sZW5ndGggKSB7XG5cdFx0XHRwcm9jZXNzT3V0Ym91bmRRKCBfb3V0Ym91bmRRdWV1ZS5zaGlmdCgpICk7XG5cdFx0fVxuXHRcdHdoaWxlICggX2luYm91bmRRdWV1ZS5sZW5ndGggKSB7XG5cdFx0XHRwcm9jZXNzSW5ib3VuZFEoIF9pbmJvdW5kUXVldWUuc2hpZnQoKSApO1xuXHRcdH1cblx0fVxufSApO1xuXG5pZiAoIHBvc3RhbC5pbnN0YW5jZUlkKCkgIT09IHVuZGVmaW5lZCApIHtcblx0X3JlYWR5ID0gdHJ1ZTtcbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2luZGV4LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXztcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwiX1wiXG4gKiogbW9kdWxlIGlkID0gMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzJfXztcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwicG9zdGFsXCJcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 571432001af90c4f1ed7\n **/","import _ from \"lodash\";\nimport postal from \"postal\";\n\nif ( !postal.createUUID ) {\n\tpostal.createUUID = function() {\n\t\tlet s = [];\n\t\tconst hexDigits = \"0123456789abcdef\";\n\t\tfor ( let i = 0; i < 36; i++ ) {\n\t\t\ts[i] = hexDigits.substr( Math.floor( Math.random() * 0x10 ), 1 );\n\t\t}\n\t\ts[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n\t\t/* jshint ignore:start */\n\t\ts[19] = hexDigits.substr( ( s[19] & 0x3 ) | 0x8, 1 ); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n\t\t/* jshint ignore:end */\n\t\ts[8] = s[13] = s[18] = s[23] = \"-\";\n\t\treturn s.join( \"\" );\n\t};\n}\nif ( !postal.instanceId ) {\n\tpostal.instanceId = ( function() {\n\t\tlet _id, _oldId;\n\t\treturn function( id ) {\n\t\t\tif ( id ) {\n\t\t\t\t_oldId = _id;\n\t\t\t\t_id = id;\n\t\t\t\tpostal.publish( {\n\t\t\t\t\tchannel: postal.configuration.SYSTEM_CHANNEL,\n\t\t\t\t\ttopic: \"instanceId.changed\",\n\t\t\t\t\tdata: {\n\t\t\t\t\t\toldId: _oldId,\n\t\t\t\t\t\tnewId: _id\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn _id;\n\t\t};\n\t}() );\n}\n\nconst NO_OP = function() {};\nlet _ready = false;\nlet _inboundQueue = [];\nlet _outboundQueue = [];\nlet _signalQueue = [];\nconst _defaults = {\n\tenabled: true,\n\tfilterMode: \"whitelist\",\n\tfilterDirection: \"both\"\n};\nlet _config = _defaults;\nfunction _matchesFilter( channel, topic, direction ) {\n\tconst channelPresent = Object.prototype.hasOwnProperty.call( fedx.filters[direction], channel );\n\tconst topicMatch = ( channelPresent && _.any( fedx.filters[direction][channel], function( binding ) {\n\t\treturn postal.configuration.resolver.compare( binding, topic );\n\t} ) );\n\tconst blacklisting = _config.filterMode === \"blacklist\";\n\treturn _config.enabled && ( ( blacklisting && ( !channelPresent || ( channelPresent && !topicMatch ) ) ) || ( !blacklisting && channelPresent && topicMatch ) );\n};\n\nconst packingSlips = {\n\tping: function() {\n\t\treturn {\n\t\t\ttype: \"federation.ping\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tticket: postal.createUUID()\n\t\t};\n\t},\n\tpong: function( ping ) {\n\t\treturn {\n\t\t\ttype: \"federation.pong\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tpingData: {\n\t\t\t\tinstanceId: ping.instanceId,\n\t\t\t\ttimeStamp: ping.timeStamp,\n\t\t\t\tticket: ping.ticket\n\t\t\t}\n\t\t};\n\t},\n\tmessage: function( env ) {\n\t\treturn {\n\t\t\ttype: \"federation.message\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tenvelope: env\n\t\t};\n\t},\n\tdisconnect: function() {\n\t\treturn {\n\t\t\ttype: \"federation.disconnect\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date()\n\t\t};\n\t},\n\tbundle: function( packingSlips ) {\n\t\treturn {\n\t\t\ttype: \"federation.bundle\",\n\t\t\tinstanceId: postal.instanceId(),\n\t\t\ttimeStamp: new Date(),\n\t\t\tpackingSlips: packingSlips\n\t\t};\n\t}\n};\nconst handlers = {\n\t\"federation.ping\": function( data /*, callback */ ) {\n\t\tdata.source.setInstanceId( data.packingSlip.instanceId );\n\t\tif ( data.source.handshakeComplete ) {\n\t\t\tdata.source.sendPong( data.packingSlip );\n\t\t} else {\n\t\t\tdata.source.sendBundle( [\n\t\t\tfedx.getPackingSlip( \"pong\", data.packingSlip ),\n\t\t\tfedx.getPackingSlip( \"ping\" )\n\t\t\t] );\n\t\t}\n\t},\n\t\"federation.pong\": function( data ) {\n\t\tdata.source.handshakeComplete = true;\n\t\tdata.source.setInstanceId( data.packingSlip.instanceId );\n\t\tif ( data.source.pings[data.packingSlip.pingData.ticket] ) {\n\t\t\tdata.source.pings[data.packingSlip.pingData.ticket].callback( {\n\t\t\t\tticket: data.packingSlip.pingData.ticket,\n\t\t\t\tinstanceId: data.packingSlip.instanceId,\n\t\t\t\tsource: data.source\n\t\t\t} );\n\t\t\tdata.source.pings[data.packingSlip.pingData.ticket] = undefined;\n\t\t}\n\t\tif ( !_.contains( fedx.clients, data.packingSlip.instanceId ) ) {\n\t\t\tfedx.clients.push( data.packingSlip.instanceId );\n\t\t}\n\t\tpostal.publish( {\n\t\t\tchannel: \"postal.federation\",\n\t\t\ttopic: \"client.federated\",\n\t\t\tdata: {\n\t\t\t\tremoteId: data.source.instanceId,\n\t\t\t\tlocalId: postal.instanceId(),\n\t\t\t\ttransport: data.transport\n\t\t\t}\n\t\t} );\n\t},\n\t\"federation.disconnect\": function( data ) {\n\t\tfedx.clients = _.without( fedx.clients, data.source.instanceId );\n\t\tfedx.disconnect( {\n\t\t\ttransport: data.source.transportName,\n\t\t\tinstanceId: data.source.instanceId,\n\t\t\tdoNotNotify: true\n\t\t} );\n\t},\n\t\"federation.message\": function( data ) {\n\t\tconst env = data.packingSlip.envelope;\n\t\tif ( _matchesFilter( env.channel, env.topic, \"in\" ) ) {\n\t\t\tenv.lastSender = data.packingSlip.instanceId;\n\t\t\tpostal.publish( env );\n\t\t}\n\t},\n\t\"federation.bundle\": function( data ) {\n\t\t_.each( data.packingSlip.packingSlips, function( slip ) {\n\t\t\tfedx.onFederatedMsg( _.extend( {}, data, {\n\t\t\t\tpackingSlip: slip\n\t\t\t} ) );\n\t\t} );\n\t}\n};\n\nfunction FederationClient( target, options, instanceId ) {\n\tthis.target = target;\n\tthis.options = options || {};\n\tthis.pings = {};\n\tthis.instanceId = instanceId;\n\tthis.handshakeComplete = false;\n};\n\nFederationClient.prototype.sendPing = function( callback ) {\n\tconst packingSlip = fedx.getPackingSlip( \"ping\" );\n\tthis.pings[packingSlip.ticket] = {\n\t\tticket: packingSlip.ticket,\n\t\tcallback: callback || NO_OP\n\t};\n\tthis.send( packingSlip );\n};\n\nFederationClient.prototype.sendPong = function( origPackingSlip ) {\n\tthis.send( fedx.getPackingSlip( \"pong\", origPackingSlip ) );\n};\n\nFederationClient.prototype.sendBundle = function( slips ) {\n\tthis.send( fedx.getPackingSlip( \"bundle\", slips ) );\n};\n\nFederationClient.prototype.sendMessage = function( envelope ) {\n\tif ( !this.handshakeComplete ) {\n\t\treturn;\n\t}\n\tenvelope.originId = envelope.originId || postal.instanceId();\n\tconst env = _.clone( envelope );\n\tif ( this.instanceId && this.instanceId !== env.lastSender &&\n\t( !env.knownIds || !env.knownIds.length ||\n\t( env.knownIds && !_.include( env.knownIds, this.instanceId ) ) )\n\t) {\n\t\tenv.knownIds = ( env.knownIds || [] ).concat( _.without( fedx.clients, this.instanceId ) );\n\t\tthis.send( fedx.getPackingSlip( \"message\", env ) );\n\t}\n};\n\nFederationClient.prototype.disconnect = function() {\n\tthis.send( fedx.getPackingSlip( \"disconnect\" ) );\n};\n\nFederationClient.prototype.onMessage = function( packingSlip ) {\n\tif ( this.shouldProcess() ) {\n\t\tfedx.onFederatedMsg( {\n\t\t\ttransport: this.transportName,\n\t\t\tpackingSlip: packingSlip,\n\t\t\tsource: this\n\t\t} );\n\t}\n};\n\nFederationClient.prototype.shouldProcess = function() {\n\treturn true;\n};\n\nFederationClient.prototype.send = function( /* msg */ ) {\n\tthrow new Error( \"An object deriving from FederationClient must provide an implementation for 'send'.\" );\n};\n\nFederationClient.prototype.setInstanceId = function( id ) {\n\tthis.instanceId = id;\n};\n\nFederationClient.extend = function( props, ctrProps ) {\n\tfunction FedXClient() {\n\t\tFederationClient.apply( this, arguments );\n\t}\n\n\tFedXClient.prototype = Object.create( FederationClient.prototype );\n\t_.extend( FedXClient.prototype, props );\n\t_.extend( FedXClient, ctrProps );\n\n\treturn FedXClient;\n};\n\nexport default fedx = postal.fedx = {\n\tFederationClient: FederationClient,\n\tpackingSlips: packingSlips,\n\thandlers: handlers,\n\tclients: [],\n\ttransports: {},\n\tfilters: {\n\t\t\"in\": {}, // jscs:ignore disallowQuotedKeysInObjects\n\t\tout: {}\n\t},\n\taddFilter: function( filters ) {\n\t\tfilters = _.isArray( filters ) ? filters : [ filters ];\n\t\t_.each( filters, function( filter ) {\n\t\t\tfilter.direction = filter.direction || _config.filterDirection;\n\t\t\t_.each( ( filter.direction === \"both\" ) ? [ \"in\", \"out\" ] : [ filter.direction ], function( dir ) {\n\t\t\t\tif ( !this.filters[dir][filter.channel] ) {\n\t\t\t\t\tthis.filters[dir][filter.channel] = [ filter.topic ];\n\t\t\t\t} else if ( !( _.include( this.filters[dir][filter.channel], filter.topic ) ) ) {\n\t\t\t\t\tthis.filters[dir][filter.channel].push( filter.topic );\n\t\t\t\t}\n\t\t\t}, this );\n\t\t}, this );\n\t},\n\tremoveFilter: function( filters ) {\n\t\tfilters = _.isArray( filters ) ? filters : [ filters ];\n\t\t_.each( filters, function( filter ) {\n\t\t\tfilter.direction = filter.direction || _config.filterDirection;\n\t\t\t_.each( ( filter.direction === \"both\" ) ? [ \"in\", \"out\" ] : [ filter.direction ], function( dir ) {\n\t\t\t\tif ( this.filters[dir][filter.channel] && _.include( this.filters[dir][filter.channel], filter.topic ) ) {\n\t\t\t\t\tthis.filters[dir][filter.channel] = _.without( this.filters[dir][filter.channel], filter.topic );\n\t\t\t\t}\n\t\t\t}, this );\n\t\t}, this );\n\t},\n\tcanSendRemote: function( channel, topic ) {\n\t\treturn _matchesFilter( channel, topic, \"out\" );\n\t},\n\tconfigure: function( cfg ) {\n\t\tif ( cfg && cfg.filterMode && cfg.filterMode !== \"blacklist\" && cfg.filterMode !== \"whitelist\" ) {\n\t\t\tthrow new Error( \"postal.fedx filterMode must be 'blacklist' or 'whitelist'.\" );\n\t\t}\n\t\tif ( cfg ) {\n\t\t\t_config = _.defaults( cfg, _defaults );\n\t\t}\n\t\treturn _config;\n\t},\n\tgetPackingSlip: function( type /*, env */ ) {\n\t\tif ( Object.prototype.hasOwnProperty.call( packingSlips, type ) ) {\n\t\t\treturn packingSlips[type].apply( this, Array.prototype.slice.call( arguments, 1 ) );\n\t\t}\n\t},\n\tonFederatedMsg: function( data ) {\n\t\tif ( !_ready ) {\n\t\t\t_inboundQueue.push( data );\n\t\t\treturn;\n\t\t}\n\t\tif ( Object.prototype.hasOwnProperty.call( handlers, data.packingSlip.type ) ) {\n\t\t\thandlers[data.packingSlip.type]( data );\n\t\t} else {\n\t\t\tthrow new Error( \"postal.federation does not have a message handler for '\" + data.packingSlip.type + \"'.\" );\n\t\t}\n\t},\n\tsendMessage: function( envelope ) {\n\t\tif ( !_ready ) {\n\t\t\t_outboundQueue.push( arguments );\n\t\t\treturn;\n\t\t}\n\t\t_.each( this.transports, function( transport ) {\n\t\t\ttransport.sendMessage( envelope );\n\t\t} );\n\t},\n\tdisconnect: function( options ) {\n\t\toptions = options || {};\n\t\tlet transports = this.transports;\n\t\tif ( options.transport ) {\n\t\t\ttransports = {};\n\t\t\ttransports[options.transport] = this.transports[options.transport];\n\t\t}\n\t\t_.each( transports, function( transport ) {\n\t\t\ttransport.disconnect( {\n\t\t\t\ttarget: options.target,\n\t\t\t\tinstanceId: options.instanceId,\n\t\t\t\tdoNotNotify: !!options.doNotNotify\n\t\t\t} );\n\t\t}, this );\n\t},\n\t_getTransports: function() {\n\t\treturn _.reduce( this.transports, function( memo, transport, name ) {\n\t\t\tmemo[name] = true;\n\t\t\treturn memo;\n\t\t}, {} );\n\t},\n\t/*\n\t\tsignalReady( callback );\n\t\tsignalReady( \"transportName\" );\n\t\tsignalReady( \"transportName\", callback );\n\t\tsignalReady( \"transportName\", targetInstance, callback ); <-- this is NEW\n\t\tsignalReady( { transportNameA: targetsForA, transportNameB: targetsForB, transportC: true }, callback);\n\t*/\n\tsignalReady: function( transport, target, callback ) {\n\t\tif ( !_ready ) {\n\t\t\t_signalQueue.push( arguments );\n\t\t\treturn;\n\t\t}\n\t\tlet transports = this._getTransports();\n\t\tswitch ( arguments.length ) {\n\t\tcase 1:\n\t\t\tif ( typeof transport === \"function\" ) {\n\t\t\t\tcallback = transport;\n\t\t\t} else if ( typeof transport === \"string\" ) {\n\t\t\t\ttransports = {};\n\t\t\t\ttransports[transport] = this.transports[transport];\n\t\t\t\tcallback = NO_OP;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tif ( typeof transport === \"string\" ) {\n\t\t\t\ttransports = {};\n\t\t\t\ttransports[transport] = this.transports[transport];\n\t\t\t} else {\n\t\t\t\ttransports = transport;\n\t\t\t}\n\t\t\tcallback = target || NO_OP;\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\ttransports = {};\n\t\t\ttransports[transport] = [ target ];\n\t\t\tbreak;\n\t\t}\n\t\t_.each( transports, function( targets, name ) {\n\t\t\ttargets = typeof targets === \"boolean\" ? [] : targets;\n\t\t\tthis.transports[name].signalReady( targets, callback );\n\t\t}, this );\n\t}\n};\n\nfunction processSignalQ( args ) {\n\tfedx.signalReady.apply( this, args );\n}\n\nfunction processOutboundQ( args ) {\n\tfedx.send.apply( this, args );\n}\n\nfunction processInboundQ( msg ) {\n\tfedx.onFederatedMsg.call( this, msg );\n}\n\npostal.addWireTap( function( data, envelope ) {\n\tif ( fedx.canSendRemote( envelope.channel, envelope.topic ) ) {\n\t\tfedx.sendMessage( envelope );\n\t}\n} );\n\npostal.subscribe( {\n\tchannel: postal.configuration.SYSTEM_CHANNEL,\n\ttopic: \"instanceId.changed\",\n\tcallback: function() {\n\t\t_ready = true;\n\t\twhile ( _signalQueue.length ) {\n\t\t\tprocessSignalQ( _signalQueue.shift() );\n\t\t}\n\t\twhile ( _outboundQueue.length ) {\n\t\t\tprocessOutboundQ( _outboundQueue.shift() );\n\t\t}\n\t\twhile ( _inboundQueue.length ) {\n\t\t\tprocessInboundQ( _inboundQueue.shift() );\n\t\t}\n\t}\n} );\n\nif ( postal.instanceId() !== undefined ) {\n\t_ready = true;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"_\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"postal\"\n ** module id = 2\n ** module chunks = 0\n **/"],"sourceRoot":"/source/"}